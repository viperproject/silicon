field f: Int

method exhaleInhale(a: Ref)
    requires @dependency("Explicit")(acc(a.f))
{
    @irrelevant("Implicit")
    exhale acc(a.f, 1/2)
    @irrelevant("Explicit")
    inhale acc(a.f, 1/2)

    // $PrecisionTest: $READ_WRITE=a.f $ACC_INVARIANT=acc(a.f)

    @testAssertion("Explicit")
    assert perm(a.f) == write
}

method exhaleImprecision(){
    var x: Ref

    @dependency("Explicit")
    inhale acc(x.f)
    @dependency("Explicit")
    inhale x.f > 0

    @irrelevant("Implicit")
    exhale acc(x.f, 1/2)

    // $PrecisionTest: $READ_ONLY=x.f $INVARIANT=x.f>0 $ACC_INVARIANT=acc(x.f,1/2)

    @testAssertion("Explicit")
    assert x.f > 0
}

method inhaleImprecision(){
    var x: Ref

    @dependency("Explicit")
    inhale acc(x.f, 1/2)
    @dependency("Explicit")
    inhale x.f > 0

    @irrelevant("Implicit")
    inhale acc(x.f, 1/2)

    // $PrecisionTest: $READ_ONLY=x.f $INVARIANT=x.f>0 $ACC_INVARIANT=acc(x.f)

    @testAssertion("Explicit")
    assert x.f > 0
}