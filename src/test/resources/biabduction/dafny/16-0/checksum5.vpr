//import "examples-16.0.vpr"

function Hash(s: Int): Int
{
    s % 137
}

field checksumData: Int

adt Option[T] {
    Some(value: T)
    None()
}

field ocs: Option[Int]

predicate ChecksumMachineOCS(this: Ref) 
{
    acc(this.checksumData) && 0 <= this.checksumData &&
    acc(this.ocs)
}

method ChecksumOCS(this: Ref) returns (checksum: Int)
    requires ChecksumMachineOCS(this)
    //ensures ChecksumMachineOCS(this)
{
    //unfold ChecksumMachineOCS(this)
    if (this.ocs.isNone)
    {
        this.ocs := Some(this.checksumData % 137)
    }
    checksum := this.ocs.value
    //fold ChecksumMachineOCS(this)
}